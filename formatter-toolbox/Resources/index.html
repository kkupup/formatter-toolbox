<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Formatter Toolbox</title>
    </head>
    <script src="split.min.js"></script>
    <script src="xml-formatter.js"></script>
    <style>
        @font-face {
            font-family: 'JetBrainsMono-Regular';
            src: url('JetBrainsMono-Regular.woff2') format('woff2');
        }

        html,
        body {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            font-family: 'JetBrainsMono-Regular';
        }

        .global {
            width: calc(100% - 12px);
            height: 100%;
            padding: 0 6px;
            display: flex;
            flex-direction: column;
            flex-wrap: nowrap;
        }

        .upper {
            width: 100%;
            height: 40px;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: space-between;
        }

        .upper-group {
            display: flex;
            flex-direction: row;
            align-items: center;
        }

        .upper-btn {
            width: 70px;
            height: 25px;
            margin-right: 10px;
            color: #323232;
            background: white;
            border: 1px solid #bbbbbb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'JetBrainsMono-Regular';
        }

        .upper-btn:hover {
            background: #323232;
            color: white;
            border: 1px solid #323232;
        }

        .active-btn {
            background: #323232;
            color: white;
            border: 1px solid #323232;
        }

        .format-btn {
            width: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'JetBrainsMono-Regular';
        }

        .format-btn > svg {
            height: 13px;
        }

        .success-div {
            height: 30px;
            padding: 0 10px;
            margin-right: 10px;
            line-height: 30px;
            border-radius: 5px;
            background: #ccf7cd;
            color: #33a000;
            font-size: 13px;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .error-div {
            height: 30px;
            padding: 0 10px;
            margin-right: 10px;
            line-height: 30px;
            border-radius: 5px;
            background: #ffcaca;
            color: #d80000;
            font-size: 13px;
            display: none;
            align-items: center;
            justify-content: center;
        }

        @keyframes shake {
            0% {
                transform: translate(0, 0);
            }

            10% {
                transform: translate(-5px, 0);
            }

            20% {
                transform: translate(5px, 0);
            }

            30% {
                transform: translate(-5px, 0);
            }

            40% {
                transform: translate(5px, 0);
            }

            50% {
                transform: translate(-5px, 0);
            }

            60% {
                transform: translate(5px, 0);
            }

            70% {
                transform: translate(-5px, 0);
            }

            80% {
                transform: translate(5px, 0);
            }

            90% {
                transform: translate(-5px, 0);
            }

            100% {
                transform: translate(0, 0);
            }
        }

        .shake-element {
            animation: shake 1s;
        }

        .setting-btn {
            font-size: larger;
            cursor: pointer;
            transition: transform 0.3s;
            margin-right: 10px;
        }

        .setting-btn:hover {
            transform: rotate(360deg);
        }

        .history-btn {
            font-size: larger;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .history-btn:hover {
            transform: rotate(360deg);
        }

        .content {
            width: 100%;
            height: calc(100% - 80px);
        }

        .content > textarea {
            width: 100%;
            height: 100%;
            resize: none;
            border: 0;
            font-size: 14px;
            color: #323232;
            font-family: 'JetBrainsMono-Regular';
        }

        .content > textarea::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        .content > textarea::-webkit-scrollbar-thumb {
            border-radius: 3px;
            -moz-border-radius: 3px;
            -webkit-border-radius: 3px;
            background-color: #c3c3c3;
        }

        .content > textarea::-webkit-scrollbar-track {
            background-color: transparent;
        }

        .content > textarea:focus {
            outline: none;
        }

        .setting {
            top: 40px;
            right: 10px;
            position: absolute;
            width: 190px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4), 0 0 6px rgba(0, 0, 0, 0.04);
            background: white;
            border-radius: 12px;
            display: none;
        }

        .setting-inner {
            width: calc(100% - 20px);
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .setting-row {
            height: 30px;
            width: 100%;
            margin-bottom: 10px;
            display: flex;
            flex-direction: row;
            align-items: center;
        }

        .setting-label {
            width: 100px;
            font-size: 13px;
            color: #323232;
        }

        .setting-row > div {
            width: 70px;
            display: flex;
        }

        .setting-number {
            width: 55px;
            border-radius: 5px;
            border: 1px solid #aaaaaa;
            padding-left: 6px;
        }

        .setting-number:focus {
            outline: 1px solid #aaaaaa;
        }

        .setting-confirm {
            width: 100%;
            height: 100%;
            color: white;
            background-color: #323232;
            border: 0;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .setting-confirm:hover {
            background-color: #636363;
        }

        .footer {
            width: 100%;
            height: 40px;
            display: flex;
            flex-direction: row;
            align-items: center;
        }

        .copy-animations {
            bottom: 30px;
            width: 100px;
            height: 25px;
            line-height: 25px;
            text-align: center;
            position: absolute;
            font-size: 13px;
            color: #33a000;
            opacity: 0;
        }

        .copy-animations > svg {
            height: 13px;
        }

        .footer-btn {
            width: 100px;
            height: 25px;
            margin-right: 10px;
            color: #323232;
            background: white;
            border: 1px solid #bbbbbb;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'JetBrainsMono-Regular';
        }

        .footer-btn > svg {
            height: 13px;
        }

        .footer-btn:hover {
            background: #323232;
            color: white;
            border: 1px solid #323232;
        }

        .history {
            top: 0;
            right: 0;
            width: 0;
            height: 0;
            position: absolute;
            background: white;
            transition: all 0.3s;
            transition-delay: 0ms;
            overflow: hidden;
            display: flex;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4), 0 0 6px rgba(0, 0, 0, 0.04);
        }

        .history-fullscreen {
            width: 100%;
            height: 100%;
            transition-delay: 300ms;
        }

        .history-aside {
            width: 200px;
            height: 100%;
            min-width: 200px;
            display: flex;
            flex-direction: column;
        }

        .history-no-records {
            width: 100%;
            height: calc(100% - 40px);
            display: none;
            color: #323232;
            flex-direction: column;
            align-items: center;
        }

        .history-no-records > svg {
            margin-top: 100px;
            margin-bottom: 10px;
        }

        .history-records {
            width: 100%;
            height: calc(100% - 40px);
            overflow: auto;
            overflow-x: hidden;
        }

        .history-records::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        .history-records::-webkit-scrollbar-thumb {
            border-radius: 3px;
            -moz-border-radius: 3px;
            -webkit-border-radius: 3px;
            background-color: #c3c3c3;
        }

        .card {
            width: calc(100% - 40px);
            height: 50px;
            padding: 5px 10px;
            margin: 5px 0px 10px 10px;
            border-radius: 12px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .card:hover {
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4), 0 0 5px rgba(0, 0, 0, 0.04);
        }

        .active-card {
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4), 0 0 5px rgba(0, 0, 0, 0.04);
        }

        .card-row {
            width: 100%;
            height: calc(50px / 3);
            line-height: calc(50px / 3);
            display: flex;
            align-items: center;
        }

        .card-label {
            height: 13px;
            line-height: 13px;
            font-size: 10px;
            padding: 0 5px;
            border-radius: 5px;
            color: white;
            background-color: #323232;
        }

        .card-preview {
            width: 100%;
            font-size: 8px;
            color: #a3a3a3;
            display: block;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        .history-clear-all {
            width: calc(100% - 20px);
            height: 26px;
            padding: 7px 10px;
        }

        .clear-all-btn {
            width: 100%;
            height: 26px;
            color: #d80000;
            background: white;
            border: 0;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'JetBrainsMono-Regular';
        }

        .history-confirm {
            left: 10px;
            bottom: 40px;
            width: 180px;
            height: 0;
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            border-radius: 12px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4), 0 0 6px rgba(0, 0, 0, 0.04);
            transition: all 0.3s;
            overflow: hidden;
        }

        .history-confirm > span {
            margin-top: 5px;
            margin-bottom: 10px;
        }

        .history-confirm-btn {
            height: 25px;
            margin: 0 5px;
            font-size: 12px;
            border-radius: 5px;
            border: 1px solid #323223;
            cursor: pointer;
            transition: all 0.3s;
        }

        .history-confirm-btn:hover {
            transform: translateY(-3px);
        }

        .history-confirm-cancel {
            color: #323232;
            background: white;
        }

        .history-confirm-confirm {
            color: white;
            background: #323232;
        }

        .clear-all-btn:hover {
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4), 0 0 6px rgba(0, 0, 0, 0.04);
        }

        .history-main {
            width: calc(100% - 200px);
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .history-header {
            width: calc(100% - 20px);
            height: 40px;
            padding: 0 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .history-header-info {
            display: flex;
            font-size: 12px;
        }

        .history-header-info > span {
            margin: 0 10px;
            line-height: 25px;
        }

        .info-label {
            height: 23px;
            line-height: 23px;
            padding: 0 7px;
            border-radius: 5px;
            color: white;
            background-color: #323232;
        }

        .history-close-btn {
            width: 16px;
            height: 16px;
            background: url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22currentColor%22%20class%3D%22bi%20bi-door-open%22%20viewBox%3D%220%200%2016%2016%22%3E%0A%20%20%3Cpath%20d%3D%22M8.5%2010c-.276%200-.5-.448-.5-1s.224-1%20.5-1%20.5.448.5%201-.224%201-.5%201%22%2F%3E%0A%20%20%3Cpath%20d%3D%22M10.828.122A.5.5%200%200%201%2011%20.5V1h.5A1.5%201.5%200%200%201%2013%202.5V15h1.5a.5.5%200%200%201%200%201h-13a.5.5%200%200%201%200-1H3V1.5a.5.5%200%200%201%20.43-.495l7-1a.5.5%200%200%201%20.398.117M11.5%202H11v13h1V2.5a.5.5%200%200%200-.5-.5M4%201.934V15h6V1.077z%22%2F%3E%0A%3C%2Fsvg%3E);
            cursor: pointer;
        }

        .history-close-btn:hover {
            background: url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22currentColor%22%20class%3D%22bi%20bi-door-open-fill%22%20viewBox%3D%220%200%2016%2016%22%3E%0A%20%20%3Cpath%20d%3D%22M1.5%2015a.5.5%200%200%200%200%201h13a.5.5%200%200%200%200-1H13V2.5A1.5%201.5%200%200%200%2011.5%201H11V.5a.5.5%200%200%200-.57-.495l-7%201A.5.5%200%200%200%203%201.5V15zM11%202h.5a.5.5%200%200%201%20.5.5V15h-1zm-2.5%208c-.276%200-.5-.448-.5-1s.224-1%20.5-1%20.5.448.5%201-.224%201-.5%201%22%2F%3E%0A%3C%2Fsvg%3E);
        }

        .history-content {
            width: 100%;
            height: calc(100% - 40px);
            display: flex;
        }

        .history-copy-btn {
            bottom: 5px;
            right: 5px;
            width: 16px;
            height: 16px;
            cursor: pointer;
            position: absolute;
            background: white;
            background: url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2216%22%20height%3D%2216%22%20style%3D%22background-color%3A%20white%3B%22%20fill%3D%22currentColor%22%20viewBox%3D%220%200%2016%2016%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20fill-rule%3D%22evenodd%22%20d%3D%22M4%202a2%202%200%200%201%202-2h8a2%202%200%200%201%202%202v8a2%202%200%200%201-2%202H6a2%202%200%200%201-2-2zm2-1a1%201%200%200%200-1%201v8a1%201%200%200%200%201%201h8a1%201%200%200%200%201-1V2a1%201%200%200%200-1-1zM2%205a1%201%200%200%200-1%201v8a1%201%200%200%200%201%201h8a1%201%200%200%200%201-1v-1h1v1a2%202%200%200%201-2%202H2a2%202%200%200%201-2-2V6a2%202%200%200%201%202-2h1v1z%22%2F%3E%0A%20%20%20%20%3C%2Fsvg%3E)
                no-repeat;
        }

        .history-copy-btn > span {
            margin-left: 3px;
        }

        .history-content-container {
            width: calc(50% - 40px);
            min-width: 150px;
            height: calc(100% - 40px);
            padding: 10px;
            margin: 0 10px 10px 10px;
            border-radius: 12px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4), 0 0 6px rgba(0, 0, 0, 0.04);
            overflow: scroll;
            position: relative;
            font-size: 14px;
            user-select: auto;
            -webkit-user-select: auto;
            -moz-user-select: auto;
            -ms-user-select: auto;
        }

        .before > span {
            word-break: break-all;
            white-space: pre-wrap;
        }

        .after > span {
            white-space: pre;
        }

        .key {
            background-color: #323232;
            color: white;
        }

        .history-content-container::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        .history-content-container::-webkit-scrollbar-thumb {
            border-radius: 3px;
            -moz-border-radius: 3px;
            -webkit-border-radius: 3px;
            background-color: #c3c3c3;
        }

        .history-content-container::-webkit-scrollbar-track {
            background-color: transparent;
        }

        .history-content-container::-webkit-scrollbar-corner {
            background-color: transparent;
        }

        .gutter {
            background-color: #eee;
            background-repeat: no-repeat;
            background-position: 50%;
        }

        .gutter.gutter-horizontal {
            background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==');
            cursor: col-resize;
        }
    </style>

    <body>
        <div class="history" id="historyBoard">
            <div class="history-aside">
                <div class="history-no-records" id="noRecords">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 1024 1024">
                        <path
                            d="M855.6 427.2H168.5c-12.7 0-24.4 6.9-30.6 18L4.4 684.7C1.5 689.9 0 695.8 0 701.8v287.1c0 19.4 15.7 35.1 35.1 35.1H989c19.4 0 35.1-15.7 35.1-35.1V701.8c0-6-1.5-11.8-4.4-17.1L886.2 445.2c-6.2-11.1-17.9-18-30.6-18zM673.4 695.6c-16.5 0-30.8 11.5-34.3 27.7-12.7 58.5-64.8 102.3-127.2 102.3s-114.5-43.8-127.2-102.3c-3.5-16.1-17.8-27.7-34.3-27.7H119c-26.4 0-43.3-28-31.1-51.4l81.7-155.8c6.1-11.6 18-18.8 31.1-18.8h622.4c13 0 25 7.2 31.1 18.8l81.7 155.8c12.2 23.4-4.7 51.4-31.1 51.4H673.4zM819.9 209.5c-1-1.8-2.1-3.7-3.2-5.5-9.8-16.6-31.1-22.2-47.8-12.6L648.5 261c-17 9.8-22.7 31.6-12.6 48.4 0.9 1.4 1.7 2.9 2.5 4.4 9.5 17 31.2 22.8 48 13L807 257.3c16.7-9.7 22.4-31 12.9-47.8zM375.4 261.1L255 191.6c-16.7-9.6-38-4-47.8 12.6-1.1 1.8-2.1 3.6-3.2 5.5-9.5 16.8-3.8 38.1 12.9 47.8L337.3 327c16.9 9.7 38.6 4 48-13.1 0.8-1.5 1.7-2.9 2.5-4.4 10.2-16.8 4.5-38.6-12.4-48.4zM512 239.3h2.5c19.5 0.3 35.5-15.5 35.5-35.1v-139c0-19.3-15.6-34.9-34.8-35.1h-6.4C489.6 30.3 474 46 474 65.2v139c0 19.5 15.9 35.4 35.5 35.1h2.5z"
                            p-id="5204"
                        ></path>
                    </svg>
                    <span>No Records</span>
                </div>
                <div class="history-records" id="cardGroup">
                    <div class="card">
                        <div class="card-row">
                            <span>JSON</span>&nbsp;
                            <div class="card-label">FORMAT</div>
                        </div>
                        <div class="card-row card-preview">${decodeURIComponent(atob(before))}</div>
                        <div class="card-row">2024-11-11 11:11:11</div>
                    </div>
                </div>
                <div class="history-confirm" id="confirmBoard">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                        <path
                            d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0"
                        />
                    </svg>
                    <span>Confirm for clearing.</span>
                    <div>
                        <button class="history-confirm-btn history-confirm-cancel" onclick="clearBoard(false)">Cancel</button>
                        <button class="history-confirm-btn history-confirm-confirm" onclick="clearAll()">Confirm</button>
                    </div>
                </div>
                <div class="history-clear-all">
                    <button class="clear-all-btn" onclick="clearBoard(true)">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z" />
                            <path
                                fill-rule="evenodd"
                                d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"
                            />
                        </svg>
                        &nbsp;Clear All
                    </button>
                </div>
            </div>
            <div class="history-main">
                <div class="history-header">
                    <div class="history-header-info">
                        <div class="info-label">Type</div>
                        <span id="detailType">-</span>
                        <div class="info-label">Operation</div>
                        <span id="detailOperation">-</span>
                        <div class="info-label">Datetime</div>
                        <span id="detailDatetime">-</span>
                    </div>
                    <div class="history-close-btn" onclick="closeHistory()"></div>
                </div>
                <div class="history-content">
                    <div class="history-content-container before" id="before">
                        <div class="history-copy-btn" id="historyCopyBtnBefore" onclick="copy('detailBefore', 'historyCopyBtnBefore')"></div>
                        <span id="detailBefore"></span>
                    </div>
                    <div class="history-content-container after" id="after">
                        <div class="history-copy-btn" id="historyCopyBtnAfter" onclick="copy('detailAfter', 'historyCopyBtnAfter')"></div>
                        <span id="detailAfter"></span>
                    </div>
                </div>
            </div>
        </div>
        <div class="setting" id="settingBoard">
            <div class="setting-inner">
                <div class="setting-row">
                    <span class="setting-label">Indentation</span>
                    <div>
                        <input class="setting-number" id="indentNumber" type="number" value="4" min="0" max="10" required />
                    </div>
                </div>
                <div class="setting-row" style="margin-bottom: unset">
                    <button class="setting-confirm" onclick="saveSetting()">Confirm</button>
                </div>
            </div>
        </div>
        <div class="global">
            <div class="upper">
                <div class="upper-group">
                    <button class="upper-btn active-btn" onclick="chooseTag('JSON', event)">JSON</button>
                    <button class="upper-btn" onclick="chooseTag('XML', event)">XML</button>
                    <button class="upper-btn" onclick="chooseTag('HTML', event)">HTML</button>
                </div>
                <div class="upper-group">
                    <div class="success-div shake-element" id="successId">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                            <path d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z" />
                        </svg>
                        &nbsp;<span id="successMsg"></span>
                    </div>
                    <div class="error-div shake-element" id="errorId">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                            <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
                        </svg>
                        &nbsp;<span id="errorMsg"></span>
                    </div>
                    <button class="upper-btn format-btn" onclick="format()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-code-slash" viewBox="0 0 16 16">
                            <path
                                d="M10.478 1.647a.5.5 0 1 0-.956-.294l-4 13a.5.5 0 0 0 .956.294l4-13zM4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0zm6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0z"
                            />
                        </svg>
                        &nbsp;Format
                    </button>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="setting-btn" viewBox="0 0 16 16" title="Setting" onclick="setting(settingVisible = !settingVisible)">
                        <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z" />
                        <path
                            d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"
                        />
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="history-btn" viewBox="0 0 16 16" title="History" onclick="openHistory()" id="historyBtn">
                        <path
                            d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022zm2.004.45a7 7 0 0 0-.985-.299l.219-.976q.576.129 1.126.342zm1.37.71a7 7 0 0 0-.439-.27l.493-.87a8 8 0 0 1 .979.654l-.615.789a7 7 0 0 0-.418-.302zm1.834 1.79a7 7 0 0 0-.653-.796l.724-.69q.406.429.747.91zm.744 1.352a7 7 0 0 0-.214-.468l.893-.45a8 8 0 0 1 .45 1.088l-.95.313a7 7 0 0 0-.179-.483m.53 2.507a7 7 0 0 0-.1-1.025l.985-.17q.1.58.116 1.17zm-.131 1.538q.05-.254.081-.51l.993.123a8 8 0 0 1-.23 1.155l-.964-.267q.069-.247.12-.501m-.952 2.379q.276-.436.486-.908l.914.405q-.24.54-.555 1.038zm-.964 1.205q.183-.183.35-.378l.758.653a8 8 0 0 1-.401.432z"
                        />
                        <path d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0z" />
                        <path d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5" />
                    </svg>
                </div>
            </div>
            <div class="content">
                <textarea id="textarea" placeholder="Please input JSON data or import JSON file ..." onfocus="setting(false)"></textarea>
            </div>
            <div class="footer">
                <div class="copy-animations" id="copyAnimations">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check-circle-fill" viewBox="0 0 16 16">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
                    </svg>
                    Copied
                </div>
                <button class="footer-btn" onclick="copy('textarea')">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path
                            fill-rule="evenodd"
                            d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1z"
                        />
                    </svg>
                    &nbsp;Copy
                </button>
                <button class="footer-btn" onclick="clean()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 1024 1024">
                        <path
                            d="M976.269717 503.930499l-91.323134-171.388329a93.527485 93.527485 0 0 0-83.292996-48.731914H662.149628a2.361805 2.361805 0 0 1-2.361805-2.283078V64.870916C659.787823 29.365111 629.477989 0.551088 592.318921 0.551088H484.541878c-37.237795 0-67.390175 28.89275-67.390174 64.319828V281.605905a2.361805 2.361805 0 0 1-2.361806 2.361805H275.128485c-35.348351 0-67.153994 18.579534-83.214269 48.653186L100.591082 503.930499a63.296379 63.296379 0 0 0 2.597986 64.713462 69.279619 69.279619 0 0 0 56.683324 31.490736C154.282787 715.548243 114.132099 835.44922 52.016623 919.529484a63.611286 63.611286 0 0 0-4.959791 68.728531c11.96648 22.043515 35.584531 35.741985 61.721842 35.741985h720.35058c41.882679 0 78.96302-27.003306 89.984778-65.579457 18.579534-64.556008 34.009995-123.28623 35.190897-188.472054a372.535404 372.535404 0 0 0-35.899439-169.813792 69.909433 69.909433 0 0 0 55.344968-31.490736 63.296379 63.296379 0 0 0 2.597986-64.713462z m-816.00369 29.050204l91.323133-171.467057a26.452218 26.452218 0 0 1 23.539325-13.69847h139.346506c38.339971 0 69.515799-29.680018 69.515799-66.287998V64.870916l0.314908-0.314908h107.85577l0.314907 0.314908V281.605905c0 36.60798 31.097102 66.287999 69.437072 66.287998h139.346506c9.998309 0 18.973168 5.274698 23.539325 13.69847l91.323134 171.467057c0.314907 0.314907 0.629815 1.102176-0.078727 2.283078-0.787268 1.102176-1.574537 1.102176-2.046898 1.102176H162.470378c-0.472361 0-1.338356 0-2.046898-1.102176-0.787268-1.180903-0.393634-1.968171-0.157453-2.361805z m727.042361 235.865611c-1.102176 57.706773-15.430461 112.3432-32.829092 172.647958a26.216038 26.216038 0 0 1-25.350042 18.500808H677.501362a353.011148 353.011148 0 0 0 40.386868-159.028216c-0.157454-19.602983-18.579534-34.403629-38.812332-31.333282a32.671638 32.671638 0 0 0-28.341662 31.726916c0.157454 48.81064-16.847544 112.264473-51.093719 158.634582H383.37789a380.250634 380.250634 0 0 0 65.658184-153.517337c3.306527-19.524256-12.517567-37.159068-33.065273-37.159068a33.065273 33.065273 0 0 0-33.065273 26.609671 313.805182 313.805182 0 0 1-21.256246 69.043438c-12.045206 28.026755-33.222726 66.366726-66.524179 95.180749H108.778674c-0.551088 0-1.417083 0-2.125625-1.259629-0.787268-1.259629-0.236181-1.889444 0.078727-2.361805 35.584531-48.023372 65.658184-107.934497 86.835704-172.962867 19.366802-59.517491 30.782194-122.184055 33.537633-183.197355h616.273699c30.703467 53.06189 45.110479 108.328131 43.929576 168.475437z"
                            p-id="1473"
                        ></path>
                    </svg>
                    &nbsp;Clean
                </button>
                <button class="footer-btn" onclick="importFile()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z" />
                        <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z" />
                    </svg>
                    &nbsp;Import
                </button>
                <button class="footer-btn" onclick="exportFile()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z" />
                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z" />
                    </svg>
                    &nbsp;Export
                </button>
            </div>
        </div>
    </body>
</html>
<script>
    let currentTAG = 'JSON';
    let settingVisible = false;
    let BI = '    ';
    let PLACEHOLDER_JSON = `Please input JSON data or import JSON file ...\n\n{\n${BI}"key1": "value1",\n${BI}"key2": [\n${BI}${BI}{\n${BI}${BI}${BI}"key3": "value3"\n${BI}${BI}},\n${BI}${BI}{\n${BI}${BI}${BI}"key4": "value4"\n${BI}${BI}}\n${BI}]\n}`;
    let PLACEHOLDER_XML = `Please input XML data or import XML file ...\n\n<?xml version="1.0" encoding="UTF-8"?>\n<key1>\n${BI}<key2>\n${BI}${BI}value2\n${BI}</key2>\n${BI}<key3>\n${BI}${BI}value3\n${BI}</key3>\n</key1>\n<key4>\n${BI}value4\n</key4>`;
    let PLACEHOLDER_HTML = `Please input HTML data or import HTML file ...\n\n<!DOCTYPE html>\n<html>\n${BI}<head>\n${BI}${BI}<meta charset="UTF-8">\n${BI}${BI}${BI}<title>\n${BI}${BI}${BI}${BI}Title\n${BI}${BI}${BI}</title>\n${BI}${BI}</meta>\n${BI}</head>\n${BI}<body>\n${BI}${BI}<h1>\n${BI}${BI}${BI}Title\n${BI}${BI}</h1>\n${BI}</body>\n</html>`;

    function chooseTag(tag, event) {
        currentTAG = tag;
        if (tag === 'JSON') {
            document.getElementById('textarea').placeholder = PLACEHOLDER_JSON;
        } else if (tag === 'XML') {
            document.getElementById('textarea').placeholder = PLACEHOLDER_XML;
        } else if (tag === 'HTML') {
            document.getElementById('textarea').placeholder = PLACEHOLDER_HTML;
        }
        let btnDoms = document.getElementsByClassName('upper-btn');
        for (let i = 0; i < btnDoms.length; i++) btnDoms[i].classList.remove('active-btn');
        event.target.classList.add('active-btn');
    }

    function format() {
        let data = document.getElementById('textarea').value;
        if (data !== '') {
            if (currentTAG === 'JSON') {
                const formatData = formatJSON(data);
                if (formatData) {
                    closeResultTag();
                    document.getElementById('textarea').value = formatData;
                    saveHistory(currentTAG, 'FORMAT', data, formatData);
                }
            } else if (currentTAG === 'XML') {
                const formatData = formatXML(data);
                if (formatData) {
                    closeResultTag();
                    document.getElementById('textarea').value = formatData;
                    saveHistory(currentTAG, 'FORMAT', data, formatData);
                }
            }
        }
    }

    // {"ceshi":"测试测试","ceshi":{"asdasd":"adasdasdasd","asdxxxxx":[{"a":"a"},{"c":"c"},{"b":"b"}]}}
    function formatJSON(json) {
        try {
            const indent = document.getElementById('indentNumber').value || 4;
            if (json.indexOf('{') == -1) throw new Error();
            let parseJSON = JSON.parse(json);
            return JSON.stringify(parseJSON, null, Number(indent));
        } catch (e) {
            error(true, 'Data Error');
            return undefined;
        }
    }

    // <?xml version="1.0" encoding="UTF-8" standalone="yes"?><result><code>返回码</code><msg>返回消息内容</msg></result>
    function formatXML(xml) {
        try {
            const indent = document.getElementById('indentNumber').value || 4;
            let space = '';
            for (let i = 0; i < Number(indent); i++) {
                space += ' ';
            }
            const xmlFormatter = require('xml-formatter');
            return xmlFormatter(xml, {
                indentation: space,
            });
        } catch (e) {
            error(true, 'Data Error');
            return undefined;
        }
    }

    function copy(id, btnId) {
        const value = document.getElementById(id).value;
        if (value && value !== '') {
            window.webkit.messageHandlers.copyTextHandler.postMessage(value);
            if (btnId) {
                document.getElementById(btnId).animate(
                    [
                        {
                            background: `url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20style%3D%22color%3A%2333a000%22%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22currentColor%22%20class%3D%22bi%20bi-check-circle-fill%22%20viewBox%3D%220%200%2016%2016%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M16%208A8%208%200%201%201%200%208a8%208%200%200%201%2016%200m-3.97-3.03a.75.75%200%200%200-1.08.022L7.477%209.417%205.384%207.323a.75.75%200%200%200-1.06%201.06L6.97%2011.03a.75.75%200%200%200%201.079-.02l3.992-4.99a.75.75%200%200%200-.01-1.05z%22%2F%3E%0A%20%20%20%20%20%20%3C%2Fsvg%3E) no-repeat`,
                        },
                        {
                            background: `url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20style%3D%22color%3A%2333a000%22%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22currentColor%22%20class%3D%22bi%20bi-check-circle-fill%22%20viewBox%3D%220%200%2016%2016%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M16%208A8%208%200%201%201%200%208a8%208%200%200%201%2016%200m-3.97-3.03a.75.75%200%200%200-1.08.022L7.477%209.417%205.384%207.323a.75.75%200%200%200-1.06%201.06L6.97%2011.03a.75.75%200%200%200%201.079-.02l3.992-4.99a.75.75%200%200%200-.01-1.05z%22%2F%3E%0A%20%20%20%20%20%20%3C%2Fsvg%3E) no-repeat`,
                        },
                        {
                            background: `url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20style%3D%22color%3A%2333a000%22%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22currentColor%22%20class%3D%22bi%20bi-check-circle-fill%22%20viewBox%3D%220%200%2016%2016%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M16%208A8%208%200%201%201%200%208a8%208%200%200%201%2016%200m-3.97-3.03a.75.75%200%200%200-1.08.022L7.477%209.417%205.384%207.323a.75.75%200%200%200-1.06%201.06L6.97%2011.03a.75.75%200%200%200%201.079-.02l3.992-4.99a.75.75%200%200%200-.01-1.05z%22%2F%3E%0A%20%20%20%20%20%20%3C%2Fsvg%3E) no-repeat`,
                        },
                    ],
                    {
                        duration: 1000,
                        iterations: 1,
                    },
                );
            } else {
                document.getElementById('copyAnimations').animate(
                    [
                        { transform: 'translate(0, 0)', opacity: 1 },
                        { transform: 'translate(0, -1px)', opacity: 0.9 },
                        { transform: 'translate(0, -2px)', opacity: 0.8 },
                        { transform: 'translate(0, -3px)', opacity: 0.7 },
                        { transform: 'translate(0, -4px)', opacity: 0.6 },
                        { transform: 'translate(0, -5px)', opacity: 0.5 },
                        { transform: 'translate(0, -6px)', opacity: 0.4 },
                        { transform: 'translate(0, -7px)', opacity: 0.3 },
                        { transform: 'translate(0, -8px)', opacity: 0.2 },
                        { transform: 'translate(0, -9px)', opacity: 0.1 },
                        { transform: 'translate(0, -10px)', opacity: 0 },
                    ],
                    {
                        duration: 300,
                        iterations: 1,
                    },
                );
            }
        }
    }

    function clean() {
        document.getElementById('textarea').value = '';
    }

    function error(bool, errorMsg) {
        if (bool) {
            document.getElementById('errorMsg').innerHTML = errorMsg;
            document.getElementById('errorId').style.display = 'flex';
        } else document.getElementById('errorId').style.display = 'none';
    }

    function success(bool, successMsg) {
        if (bool) {
            document.getElementById('successMsg').innerHTML = successMsg;
            document.getElementById('successId').style.display = 'flex';
        } else document.getElementById('successId').style.display = 'none';
    }

    function closeResultTag() {
        success(false);
        error(false);
    }

    function setting(Bool) {
        settingVisible = Bool;
        if (Bool) {
            getSetting();
            document.getElementById('settingBoard').style.display = 'block';
        } else document.getElementById('settingBoard').style.display = 'none';
    }

    function getSetting() {
        window.webkit.messageHandlers.getSettingHandler.postMessage('');
        return new Promise(function (resolve, reject) {
            window.getSettingResolve = resolve;
        }).then(function (result) {
            if (result >= 0 && result <= 10) document.getElementById('indentNumber').value = result;
            else document.getElementById('indentNumber').value = 4;
        });
    }

    function saveSetting() {
        let indent = Number(document.getElementById('indentNumber').value);
        if (indent >= 0 && indent <= 10) {
            window.webkit.messageHandlers.saveSettingHandler.postMessage(`{"indent":${indent}}`);
            return new Promise(function (resolve, reject) {
                window.saveSettingResolve = resolve;
            }).then(function (result) {
                if (Boolean(result)) {
                    success(true, 'Change Success');
                } else {
                    error(true, 'Change Error');
                }
            });
        } else {
            error(true, 'Indent is 0 to 10');
        }
    }

    function saveHistory(type, operate, before, after) {
        window.webkit.messageHandlers.saveHistoryHandler.postMessage(`{"type":"${type}","operate":"${operate}","before":"${btoa(encodeURI(before))}","after":"${btoa(encodeURIComponent(after))}"}`);
    }

    function importFile() {
        window.webkit.messageHandlers.importFileHandler.postMessage(currentTAG.toLowerCase());
        return new Promise(function (resolve, reject) {
            window.importFileResolve = resolve;
        }).then(function (result) {
            if (result && result != '') document.getElementById('textarea').value = atob(result);
        });
    }

    function exportFile() {
        if (document.getElementById('textarea').value != '') {
            window.webkit.messageHandlers.exportFileHandler.postMessage(currentTAG.toLowerCase().padEnd(10, ':') + document.getElementById('textarea').value);
        }
    }

    function resizeWindow(trend) {
        window.webkit.messageHandlers.resizeWindowHandler.postMessage(trend);
    }

    function openHistory() {
        setting(false);
        resizeWindow('b');
        document.getElementById('historyBtn').style.display = 'none';
        document.getElementById('historyBoard').classList.add('history-fullscreen');
        getCards();
    }

    function closeHistory() {
        document.getElementById('historyBtn').style.display = 'block';
        document.getElementById('historyBoard').classList.remove('history-fullscreen');
        setTimeout(function () {
            resizeWindow('s');
        }, 300);
    }

    function getCards() {
        showNoRecords(false);
        window.webkit.messageHandlers.getOperationHistoryHandler.postMessage('');
        return new Promise(function (resolve, reject) {
            window.getOperationHistoryHandlerResolve = resolve;
        }).then(function (result) {
            document.getElementById('cardGroup').innerHTML = '';
            if (result && JSON.parse(result)) {
                const tmp = JSON.parse(result);
                if (tmp.length != 0) {
                    for (let i = 0; i < tmp.length; i++) {
                        addCard(tmp[i].id, tmp[i].type, tmp[i].operate, tmp[i].date, tmp[i].before, tmp[i].after);
                    }
                    showCardDetail(tmp[0].id, tmp[0].type, tmp[0].operate, tmp[0].date, tmp[0].before, tmp[0].after);
                } else {
                    showNoRecords(true);
                    showCardDetail('-', '-', '-', '-', '', '');
                }
            }
        });
    }

    function showNoRecords(Bool) {
        let noRecords = document.getElementById('noRecords');
        let cardGroup = document.getElementById('cardGroup');
        if (Bool) {
            noRecords.style.display = 'flex';
            cardGroup.style.display = 'none';
        } else {
            noRecords.style.display = 'none';
            cardGroup.style.display = 'block';
        }
    }

    function addCard(id, type, operate, date, before, after) {
        let cardGroup = document.getElementById('cardGroup');
        let div = document.createElement('div');
        div.classList.add('card');
        div.setAttribute('id', id);
        div.setAttribute('onclick', `showCardDetail('${id}','${type}','${operate}','${date}','${before}','${after}')`);
        div.innerHTML = `
            <div class="card-row"><span>${type}</span>&nbsp;<div class="card-label">${operate}</div></div>
            <div class="card-row card-preview">${decodeURIComponent(atob(before))}</div>
            <div class="card-row">${date}</div>
        `;
        cardGroup.appendChild(div);
    }

    function showCardDetail(id, type, operate, date, before, after) {
        let cardDoms = document.getElementsByClassName('card');
        for (let i = 0; i < cardDoms.length; i++) cardDoms[i].classList.remove('active-card');
        document.getElementById(id).classList.add('active-card');
        document.getElementById('detailType').innerHTML = type;
        document.getElementById('detailOperation').innerHTML = operate;
        document.getElementById('detailDatetime').innerHTML = date;
        if (type === 'JSON') {
            document.getElementById('detailBefore').innerHTML = decodeURIComponent(atob(before));
            document.getElementById('detailBefore').value = decodeURIComponent(atob(before));
            document.getElementById('detailAfter').innerHTML = processAfter(decodeURIComponent(atob(after)));
            document.getElementById('detailAfter').value = decodeURIComponent(atob(after));
        } else if (type === 'XML') {
            document.getElementById('detailBefore').innerText = decodeURIComponent(atob(before));
            document.getElementById('detailBefore').value = decodeURIComponent(atob(before));
            document.getElementById('detailAfter').innerText = decodeURIComponent(atob(after));
            document.getElementById('detailAfter').value = decodeURIComponent(atob(after));
        }
    }

    function processAfter(str) {
        let posArray = [];
        let flag = false;
        for (let i = 0; i < str.length; i++) {
            if (str[i] === ':') posArray.push(i);
        }
        for (let i = posArray.length - 1; i >= 0; i--) {
            let index = posArray[i];
            for (let i = index - 1; i >= 0; i--) {
                if (str[i] === '"' && !flag) {
                    str = str.slice(0, i + 1) + '</span>' + str.slice(i + 1);
                    flag = true;
                } else if (str[i] === '"' && flag) {
                    str = str.slice(0, i) + "<span class='key' id='key'>" + str.slice(i);
                    flag = false;
                    break;
                }
            }
        }
        return str;
    }

    function clearBoard(Bool) {
        if (Bool) {
            document.getElementById('confirmBoard').style.height = '100px';
        } else {
            document.getElementById('confirmBoard').style.height = '0';
        }
    }

    function clearAll() {
        window.webkit.messageHandlers.deleteAllOperationHistoryHandler.postMessage('');
        return new Promise(function (resolve, reject) {
            window.deleteAllOperationHistoryHandlerResolve = resolve;
        }).then(function (result) {
            if (Boolean(result)) {
                getCards();
            }
        });
    }

    document.addEventListener('contextmenu', function (e) {
        if (e.target.id !== 'textarea' && e.target.id !== 'key' && e.target.id !== 'detailBefore' && e.target.id !== 'detailAfter') {
            e.preventDefault();
        }
    });

    document.addEventListener('click', function (e) {
        try {
            if (!e.target.classList[0].includes('setting')) setting(false);
        } catch (e) {}
    });

    function init() {
        document.getElementById('textarea').placeholder = PLACEHOLDER_JSON;
        Split(['#before', '#after']);
        getSetting();
    }

    init();
</script>
